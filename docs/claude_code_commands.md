# Claude Code カスタムスラッシュコマンドガイドライン

このドキュメントでは、Minervaプロジェクトにおける Claude Code のカスタムスラッシュコマンドの使用方法について説明します。

## 1. 概要

Minervaプロジェクトでは、開発効率の向上と一貫したコード品質を保つために、Claude Code のカスタムスラッシュコマンドを導入しています。これにより、プロジェクトの知識ベースを自動的に更新し、開発者が必要な情報を迅速に取得できるようになります。

## 2. カスタムスラッシュコマンドの構成

カスタム指示は `.claude/commands/` ディレクトリに配置されており、以下のような構成になっています：

```
.claude/
  commands/
    update-knowledge.md      # プロジェクト全体のリファレンス情報
    check-documentation.md   # ドキュメント更新チェック
```

## 3. カスタムスラッシュコマンドの使用方法

カスタムスラッシュコマンドは、Claude Code の機能を拡張するために使用されます。以下の手順で利用できます：
1. **コマンドの呼び出し**:
   - Claude Code のチャットウィンドウで `/` を入力すると、利用可能なカスタムスラッシュコマンドのリストが表示されます。
    - プロジェクト固有のカスタムスラッシュコマンドは、`/project:` プレフィックスを使用して呼び出します。
2. **コマンドの選択**:
   - リストから目的のコマンドを選択します。
   - 例えば、`/project:update-knowledge` を選択すると、プロジェクトの知識ベース(`CLAUDE.md`)を更新するためのプロンプトが表示されます。
3. **コマンドの実行**:
   - 必要な情報を入力し、コマンドを実行します。
   - Claude Code が自動的にプロジェクトの知識ベースを更新します。


## 4. 利用可能なコマンド

### `/project:update-knowledge`

- コマンド名（ファイル名）: `update-knowledge.md`
- 使用方法: `/project:update-knowledge`

このコマンドは以下の機能を提供します：

#### 主な特徴

- 会話履歴の分析: 現在の会話から価値のある知見や学習内容を抽出
- 既存CLAUDE.mdの確認: 現在のドキュメント構造と内容を理解
- 知識の分類: 新規・更新・強化・検証の4つのカテゴリで整理
- 構造化された更新: 既存の体系を保ちながら新しい知識を追加
- 品質保証: 正確性と有用性を確保

#### 使用タイミング

- **複雑な問題を解決した直後**: トラブルシューティングの手順や解決策を記録
- **新しいツールや技術を試した後**: 設定方法や使用方法、注意点を蓄積
- **エラーの原因究明と解決を完了した時**: 原因分析と解決手順の記録
- **コードレビューでの指摘事項を修正した後**: 改善点とベストプラクティスの記録
- **プロジェクト固有の知識を発見した時**: 独自の実装パターンや設計判断の記録
- **パフォーマンス最適化を実施した後**: 最適化手法と効果の記録

#### 実用的な使用例

- **バグ修正後**: 「Property-based testingでUnicode文字のエスケープ問題を発見→正規表現の適切な処理方法をCLAUDE.mdに追加」
- **新機能実装後**: 「ServiceManagerパターンの導入→依存性注入のベストプラクティスを追加」
- **環境設定変更後**: 「CI/CDパイプラインの最適化→テスト実行速度向上の手法を記録」

### `/project:check-documentation`

- コマンド名（ファイル名）: `check-documentation.md`
- 使用方法: `/project:check-documentation`

このコマンドは実装完了後のドキュメント更新チェックを体系的に行います：

#### 主な特徴

- **包括的チェック**: README.md、CLAUDE.md、docs/、.github/instructions/ を網羅
- **実装影響分析**: コード変更がドキュメントに与える影響を評価
- **優先度付け**: 更新の重要度に応じた優先順位付け
- **品質基準**: ドキュメントの正確性、完全性、一貫性を確保
- **検証プロセス**: 更新後の動作確認手順を提供

#### 使用タイミング

- **機能実装完了後**: 新機能の説明やAPIドキュメントの更新確認
- **バグ修正完了後**: 既知の問題や回避策の更新確認
- **リファクタリング完了後**: アーキテクチャやサービス層の説明更新確認
- **設定変更完了後**: インストール手順や環境設定の更新確認
- **依存関係更新後**: 要件やバージョン情報の更新確認
- **Pull Request作成前**: ドキュメントの整合性最終チェック

#### チェック対象

- **README.md**: インストール手順、使用例、機能一覧
- **CLAUDE.md**: プロジェクト文脈、ビルド/テストコマンド、開発ワークフロー
- **docs/ ディレクトリ**: APIドキュメント、ユーザーガイド、アーキテクチャ説明
- **'.github/instructions/ ディレクトリ**: AIエージェント向けカスタム指示
- **設定ファイル**: 環境変数例、設定説明のコメント

## 5. 注意事項とベストプラクティス

### 情報管理
- **機密情報の除外**: API キー、パスワード、個人情報は記録しない
- **重複内容の防止**: 既存の情報と重複しないよう注意深く確認
- **情報の鮮度管理**: 古くなった情報は定期的に見直し・更新

### CLAUDE.md の管理
- **肥大化の防止**: 情報量が多くなりすぎた場合は、別ドキュメントへの分割を検討
- **構造の維持**: 既存の階層構造と整合性を保つ
- **検索性の確保**: 適切なキーワードと見出しを使用

### 定期メンテナンス
- **月次レビュー**: 蓄積された知識の有効性と正確性を確認
- **四半期整理**: 使用頻度の低い情報の整理や統合
- **年次見直し**: プロジェクトの進化に合わせた全体構造の見直し

### 品質保証
- **事実確認**: 記録する情報の正確性を複数の観点から検証
- **再現性**: 他の開発者が同じ結果を得られるよう具体的に記述
- **コンテキスト**: なぜその解決策が有効だったのか背景も含めて記録

## 6. トラブルシューティング

### よくある問題
- **コマンドが見つからない**: `.claude/commands/` ディレクトリの存在とファイル名を確認
- **更新が反映されない**: Claude Code の再起動または設定の再読み込みを試行
- **重複した情報が追加される**: 実行前に既存のCLAUDE.mdの内容を十分確認

### サポート
- カスタムスラッシュコマンドに関する問題は、プロジェクトのIssueで報告
- 新しいコマンドの提案や改善要望も歓迎
